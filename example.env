# OpenAI Compatible API configuration
LLM_PROVIDER=openai
OPENAI_BASE_URL="https://api.openai.com/v1"
OPENAI_API_KEY="my_openai_api_key"
OPENAI_MODEL=gpt-5-mini
OPENAI_SUMMARY_URL="https://api.openai.com/v1"
OPENAI_SUMMARY_MODEL=gpt-5-nano
# Optional additional providers
# ANTHROPIC_API_KEY=""
# ANTHROPIC_MODEL=""
# ANTHROPIC_BASE_URL=""
# GOOGLE_LLM_API_KEY=""
# GOOGLE_LLM_MODEL="gemini-1.5-flash"
# GOOGLE_LLM_BASE_URL="https://generativelanguage.googleapis.com/"
TTS_BASE_URL="https://api.openai.com/v1/audio/speech"
TTS_MODEL="gpt-4o-mini-tts"
TTS_VOICE="alloy"

# Agent configuration
ENABLE_TOOLS=true
ALLOW_TOOLS=run_cli,apply_patch,llm_transform,describe_image,specialists_infer,multi_tool_use_parallel,web_fetch,mcp_duckduckgo_search
MAX_STEPS=1000
MAX_COMMAND_SECONDS=1200
OUTPUT_TRUNCATE_BYTES=128000

# Context Management
SUMMARY_ENABLED=true
SUMMARY_THRESHOLD=20
SUMMARY_KEEP_LAST=6

# Embedding configuration
# Used by pgvector, vector search tool, and evolving memory system
EMBED_BASE_URL="https://api.openai.com/v1"
EMBED_MODEL="text-embedding-3-small"
EMBED_API_KEY="my_openai_api_key"
EMBED_API_HEADER="Authorization"
EMBED_PATH="/v1/embeddings"
EMBED_TIMEOUT="30"

# Evolving Memory System (Search → Synthesis → Evolve)
# Based on https://arxiv.org/abs/2511.20857
# Requires embedding service configured above
EVOLVING_MEMORY_ENABLED=false
EVOLVING_MEMORY_MAX_SIZE=1000
EVOLVING_MEMORY_TOP_K=4
EVOLVING_MEMORY_WINDOW_SIZE=20
EVOLVING_MEMORY_ENABLE_RAG=true
EVOLVING_MEMORY_REMEM_ENABLED=false
EVOLVING_MEMORY_MAX_INNER_STEPS=5
EVOLVING_MEMORY_MODEL=gpt-4o-mini
# Smart pruning (advanced) - deduplication and relevance-based memory management
EVOLVING_MEMORY_ENABLE_SMART_PRUNE=false
EVOLVING_MEMORY_PRUNE_THRESHOLD=0.95
EVOLVING_MEMORY_RELEVANCE_DECAY=0.99
EVOLVING_MEMORY_MIN_RELEVANCE=0.1

# Security configuration
# Comma-separated list of binaries that are blocked from being run by the run_cli tool.
BLOCK_BINARIES=rm,sudo,chown,chmod,dd,mkfs,mount,umount

# Database connection string
DATABASE_URL="postgres://manifold:manifold@pg-manifold:5432/manifold?sslmode=disable"

# Mount Manifold project as its own working directory. 
# This can be any path you want the agents to use as their working directory.
WORKDIR="."

# Observability
# The service is not required and will just log errors if not available.
# We include it here as reference.
OTEL_SERVICE_NAME=manifold
SERVICE_VERSION=0.0.1
ENVIRONMENT=local
OTEL_EXPORTER_OTLP_ENDPOINT="localhost:4318"
LOG_PATH="manifold.log"
LOG_LEVEL=trace
LOG_PAYLOADS=true
CLICKHOUSE_DSN="http://default@clickhouse:8123?database=otel"
CLICKHOUSE_DATABASE="otel"
CLICKHOUSE_METRICS_TABLE="metrics_sum"
CLICKHOUSE_TIMESTAMP_COLUMN="TimeUnix"
CLICKHOUSE_VALUE_COLUMN="Value"
CLICKHOUSE_MODEL_ATTRIBUTE_KEY="llm.model"
CLICKHOUSE_PROMPT_METRIC_NAME="llm.prompt_tokens"
CLICKHOUSE_COMPLETION_METRIC_NAME="llm.completion_tokens"
CLICKHOUSE_LOOKBACK_HOURS=24
CLICKHOUSE_TIMEOUT_SECONDS=5

# Playground API service
PLAYGROUND_ADDR=:8081
PLAYGROUND_DSN=postgres://manifold:manifold@pg-manifold:5432/manifold?sslmode=disable
PLAYGROUND_ARTIFACT_DIR=./tmp/playground-artifacts

# Used by the internal web_search tool
# Use mcp/duckduckgo as an alternative to searxng
# See config.yaml mcp section for more details
# SEARXNG_URL="..."

# Runtime timeouts (seconds). 0 disables that specific server-side deadline.
# AGENT_RUN_TIMEOUT_SECONDS applies to non-streaming agent operations (/agent/run final, /api/prompt non-stream, vision).
# STREAM_RUN_TIMEOUT_SECONDS applies to streaming SSE paths (/agent/run, /api/prompt with Accept: text/event-stream or ?stream=1).
# WORKFLOW_TIMEOUT_SECONDS applies to /agent/workflow and /agent/specialist dispatches.
# Fallback chain:
#   streaming: STREAM_RUN_TIMEOUT_SECONDS -> AGENT_RUN_TIMEOUT_SECONDS -> 300 (default)
#   non-stream: AGENT_RUN_TIMEOUT_SECONDS -> 120 (default)
#   workflow: WORKFLOW_TIMEOUT_SECONDS -> AGENT_RUN_TIMEOUT_SECONDS -> 120 (default)
AGENT_RUN_TIMEOUT_SECONDS=0
STREAM_RUN_TIMEOUT_SECONDS=0
WORKFLOW_TIMEOUT_SECONDS=0
