# Authentication (OIDC or OAuth2) — optional
# Default false
auth:
  enabled: false
  provider: oauth2
  #issuerURL: "http://localhost:8083/realms/manifold"
  clientID: "github client id"
  clientSecret: "github client secret"
  redirectURL: "http://localhost:32180/auth/callback"
  allowedDomains: []
  cookieName: "manifold_session"
  cookieSecure: false # set true in production (HTTPS)
  cookieDomain: ""
  stateTTLSeconds: 600
  sessionTTLHours: 72
  # Optional OAuth2-only settings when provider: oauth2
  oauth2:
    authURL: "https://github.com/login/oauth/authorize"
    tokenURL: "https://github.com/login/oauth/access_token"
    userInfoURL: "https://api.github.com/user"
    logoutURL: ""
    logoutRedirectParam: "redirect_uri"
    scopes: [read:user, user:email]
    providerName: "github"
    defaultRoles: [user]
    emailField: "email"
    nameField: "name"
    pictureField: "avatar_url"
    subjectField: "id"
    rolesField: ""

llm_client:
  # Options: openai (default), anthropic, google, local
  provider: openai
  openai:
    api: completions
    summaryBaseURL: "https://api.openai.com/v1"
    summaryModel: gpt-5-nano
    # Optional: request-wide headers for the main agent
    # extraHeaders:
    #   X-App-Tenant: example
    extraParams:
      parallel_tool_calls: true
      prompt_cache_key: manifold-
      reasoning_effort: medium
  # anthropic:
  #   apiKey: ""
  #   model: ""
  #   baseURL: ""
  # google:
  #   apiKey: ""
  #   model: "gemini-1.5-flash"
  #   baseURL: "https://generativelanguage.googleapis.com/"

# No specialists configured for first launch
specialists: []

obs:
  serviceName: manifold
  environment: local
  otlp: "http://otel-collector:4318"
  clickhouse:
    dsn: "tcp://clickhouse:9000?database=otel"
    metricsTable: metrics_sum
    timestampColumn: TimeUnix
    valueColumn: Value
    modelAttributeKey: llm.model
    promptMetricName: llm.prompt_tokens
    completionMetricName: llm.completion_tokens
    lookbackHours: 24
    timeoutSeconds: 5

databases:
  defaultDSN: "postgres://manifold:manifold@pg-manifold:5432/manifold?sslmode=disable"
  chat:
    backend: postgres  # memory | auto | postgres
    dsn: "postgres://manifold:manifold@pg-manifold:5432/manifold?sslmode=disable"
  search:
    backend: postgres   # memory | postgres
    dsn: "postgres://manifold:manifold@pg-manifold:5432/manifold?sslmode=disable"
  vector:
    backend: postgres   # memory | postgres
    dsn: "postgres://manifold:manifold@pg-manifold:5432/manifold?sslmode=disable"
    #dimensions: 1536  # optional; for validation in some backends
    metric: cosine    # optional; cosine | dot | l2 (backend‑specific)
  graph:
    backend: postgres   # memory | postgres
    dsn: "postgres://manifold:manifold@pg-manifold:5432/manifold?sslmode=disable"

mcp:
  servers:
  - name: sequentialthinking
    command: docker
    args:
    - run
    - -i
    - --rm
    - mcp/sequentialthinking

  - name: duckduckgo
    command: docker
    args:
      - run
      - -i
      - --rm
      - mcp/duckduckgo

  # Remote HTTP streamable example
  - name: acme
    url: https://mcp.acme.com/mcp
    origin: https://manifold.local
    bearerToken: ${ACME_MCP_TOKEN}
    headers:
      X-Client: Manifold
    http:
      timeoutSeconds: 30
      # proxyURL: http://proxy.local:3128
      tls:
        insecureSkipVerify: false
        # caFile: /etc/ssl/certs/ca-bundle.crt
