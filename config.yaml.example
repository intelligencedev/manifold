# Authentication (OIDC) — optional
auth:
  enabled: false
  provider: oidc
  issuerURL: "http://localhost:8083/realms/manifold"
  clientID: agentd
  clientSecret: ...
  redirectURL: "http://localhost:32180/auth/callback"
  allowedDomains: []
  cookieName: "manifold_session"
  cookieSecure: false # set true in production (HTTPS)
  cookieDomain: ""
  stateTTLSeconds: 600
  sessionTTLHours: 72

openai:
  api: completions
  # Optional: request-wide headers for the main agent
  # extraHeaders:
  #   X-App-Tenant: example
  extraParams:
    parallel_tool_calls: true
    prompt_cache_key: manifold-
    reasoning_effort: medium

obs:
  serviceName: manifold
  environment: local
  otlp: "http://otel-collector:4318"
  clickhouse:
    dsn: "tcp://clickhouse:9000?database=otel"
    metricsTable: metrics_sum
    timestampColumn: TimeUnix
    valueColumn: Value
    modelAttributeKey: llm.model
    promptMetricName: llm.prompt_tokens
    completionMetricName: llm.completion_tokens
    lookbackHours: 24
    timeoutSeconds: 5

databases:
  defaultDSN: "postgres://manifold:manifold@pg-manifold:5432/manifold?sslmode=disable"
  chat:
    backend: postgres  # memory | auto | postgres
    dsn: "postgres://manifold:manifold@pg-manifold:5432/manifold?sslmode=disable"
  search:
    backend: postgres   # memory | postgres
    dsn: "postgres://manifold:manifold@pg-manifold:5432/manifold?sslmode=disable"
  vector:
    backend: postgres   # memory | postgres
    dsn: "postgres://manifold:manifold@pg-manifold:5432/manifold?sslmode=disable"
    #dimensions: 1536  # optional; for validation in some backends
    metric: cosine    # optional; cosine | dot | l2 (backend‑specific)
  graph:
    backend: postgres   # memory | postgres
    dsn: "postgres://manifold:manifold@pg-manifold:5432/manifold?sslmode=disable"

mcp:
  servers:
  - name: sequentialthinking
    command: docker
    args:
    - run
    - -i
    - --rm
    - mcp/sequentialthinking

  - name: duckduckgo
    command: docker
    args:
      - run
      - -i
      - --rm
      - mcp/duckduckgo