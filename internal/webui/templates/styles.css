/* Singularity Web UI - Glassmorphic Futuristic Chat */
/* Light/Dark dual theme using CSS variables */

:root {
  --font-stack: 'Inter', 'SF Pro Text', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Fira Sans', 'Droid Sans', 'Helvetica Neue', Arial, sans-serif;
  --mono-stack: 'JetBrains Mono', 'SFMono-Regular', Menlo, Monaco, Consolas, 'Liberation Mono', monospace;
  --radius-xs: 4px;
  --radius-sm: 8px;
  --radius: 14px;
  --radius-lg: 22px;
  --transition: 160ms cubic-bezier(.4,.0,.2,1);
  --border-alpha: 0.55;
  --glass-blur: 22px;
  --glass-sat: 160%;
  --shadow-color: 220 40% 2%;
  --header-height: 64px;
  --composer-height: 72px;

  /* Light defaults */
  --bg: #eef1f5;
  --bg-alt: #e2e7ef;
  --gradient-accent: linear-gradient(135deg,#6366f1 0%,#8b5cf6 45%,#ec4899 100%);
  --gradient-accent-soft: linear-gradient(135deg,#6366f111 0%,#8b5cf611 45%,#ec489911 100%);
  --text: #1a1f29;
  --text-soft: #4a5568;
  --text-faint: #6b7280;
  --border-rgb: 120 130 155;
  --surface-rgb: 255 255 255;
  --surface-border-rgb: 140 150 170;
  --accent: #6366f1;
  --accent-rgb: 99 102 241;
  --accent-alt: #8b5cf6;
  --danger: #dc2626;
  --success: #10b981;
  --code-bg: #101826;
  --code-text: #d1e4ff;
  --user-bubble: linear-gradient(145deg,#6366f1,#8b5cf6 60%,#ec4899);
  --agent-bubble: linear-gradient(160deg,#ffffff 0%,#f8fafc 80%);
  --tool-bubble: linear-gradient(155deg,#0f172a,#1e293b);
}

/* Dark theme override */
body[data-theme="dark"] {
  --bg: #0d1016;
  --bg-alt: #141a23;
  --text: #f1f5f9;
  --text-soft: #cbd5e1;
  --text-faint: #64748b;
  --border-rgb: 70 80 100;
  --surface-rgb: 30 38 50;
  --surface-border-rgb: 90 105 125;
  --accent: #818cf8;
  --accent-alt: #a78bfa;
  --code-bg: #0b1220;
  --code-text: #c2dafd;
  --user-bubble: linear-gradient(145deg,#6366f1,#8b5cf6 60%,#ec4899);
  --agent-bubble: linear-gradient(170deg,#1e2632,#141a23);
  --tool-bubble: linear-gradient(155deg,#0c111a,#192231);
  --shadow-color: 220 40% 4%;
}

/* Prefer system theme if not manually toggled */
@media (prefers-color-scheme: dark) {
  body:not([data-theme="light"]) {
    --bg: #0d1016;
    --bg-alt: #141a23;
    --text: #f1f5f9;
    --text-soft: #cbd5e1;
    --text-faint: #64748b;
    --border-rgb: 70 80 100;
    --surface-rgb: 30 38 50;
    --surface-border-rgb: 90 105 125;
    --accent: #818cf8;
    --accent-alt: #a78bfa;
    --code-bg: #0b1220;
    --code-text: #c2dafd;
    --agent-bubble: linear-gradient(170deg,#1e2632,#141a23);
    --tool-bubble: linear-gradient(155deg,#0c111a,#192231);
  }
}

html, body { height: 100%; }
body {
  margin: 0;
  font-family: var(--font-stack);
  background: radial-gradient(circle at 30% 20%, #6366f41a, transparent 60%), radial-gradient(circle at 80% 70%, #ec48991a, transparent 70%), var(--bg);
  color: var(--text);
  -webkit-font-smoothing: antialiased;
  text-rendering: optimizeLegibility;
  display: flex;
  flex-direction: column;
}

/* Subtle animated grid background */
body::before {
  content: '';
  position: fixed; inset: 0; pointer-events: none;
  background: repeating-linear-gradient(90deg, rgba(255,255,255,0.03) 0 1px, transparent 1px 120px), repeating-linear-gradient(0deg, rgba(255,255,255,0.025) 0 1px, transparent 1px 120px);
  mask: radial-gradient(circle at 60% 40%, black 0%, transparent 70%);
  opacity: .55;
}

header.site-header {
  position: sticky; top: 0; z-index: 40;
  backdrop-filter: blur(var(--glass-blur)) saturate(var(--glass-sat));
  -webkit-backdrop-filter: blur(var(--glass-blur)) saturate(var(--glass-sat));
  background: linear-gradient(120deg, rgba(var(--surface-rgb),0.75) 0%, rgba(var(--surface-rgb),0.45) 100%);
  border-bottom: 1px solid rgba(var(--border-rgb),0.35);
  padding: .85rem 1.4rem;
  display: flex; align-items: center; justify-content: center;
}
.logo {
  font-weight: 600; letter-spacing: .8px; font-size: 1.1rem;
  color: var(--accent);
  background: none; -webkit-background-clip: initial; background-clip: initial;
  text-shadow: none; filter: none;
}


main.layout {
  flex: 1; display: flex; align-items: stretch; gap: 1.4rem; padding: 1.1rem 1.4rem 1.4rem; box-sizing: border-box;
  max-width: 1720px; width: 100%; margin: 0 auto; position: relative;
  min-height: calc(100vh - var(--header-height));
}
.col { display: flex; flex-direction: column; min-height: 0; }
.col-left { flex: .9; }
.col-middle { flex: 2.8; min-width: 0; gap: 1rem; display: flex; flex-direction: column; min-height: 0; }
.col-right { flex: 1.2; display: flex; flex-direction: column; gap: 1rem; }
#avatar, #tools { flex: 1 1 0; } /* Equal height panels */

/* Make the chat panel grow inside the middle column so the composer sits at the bottom */
.col-middle > .panel {
  display: flex;
  flex-direction: column;
  flex: 1 1 auto;
  min-height: 0; /* allow internal scrolling */
}

/* Glass panels */
.panel {
  position: relative; display: flex; flex-direction: column;
  background: linear-gradient(140deg, rgba(var(--surface-rgb),0.60) 0%, rgba(var(--surface-rgb),0.28) 100%);

  padding: 1rem 1.15rem 1.1rem;
  backdrop-filter: blur(var(--glass-blur)) saturate(var(--glass-sat));
  -webkit-backdrop-filter: blur(var(--glass-blur)) saturate(var(--glass-sat));
  overflow: hidden;
}
.panel::before {
  content: '';
  position: absolute; inset: 0; pointer-events: none;
}
.panel-header { font-size: .72rem; text-transform: uppercase; letter-spacing: 1.2px; color: var(--text-faint); margin-bottom: .35rem; font-weight: 600; }

/* Chat area */
#chatPane { flex: 1; overflow-y: auto; padding: .25rem .35rem calc(.4rem + var(--composer-height)) .1rem; scroll-behavior: smooth; min-height: 0; }
/* Scrollbar */
#chatPane::-webkit-scrollbar, #toolsPane::-webkit-scrollbar { width: 10px; }
#chatPane::-webkit-scrollbar-track, #toolsPane::-webkit-scrollbar-track { background: transparent; }
#chatPane::-webkit-scrollbar-thumb, #toolsPane::-webkit-scrollbar-thumb { background: linear-gradient(var(--accent), var(--accent-alt)); border-radius: 20px; border: 2px solid rgba(var(--surface-rgb),0.2); }

.messages { display: flex; flex-direction: column; gap: .85rem; }
.msg { font-size: .9rem; line-height: 1.45; max-width: 88%; position: relative; word-wrap: break-word; animation: fadeIn .4s ease; }
.msg.user { align-self: flex-end; background: var(--user-bubble); color: #fff; padding: .9rem 1rem .95rem; border-radius: 18px 18px 4px 18px; box-shadow: 0 4px 14px -4px rgba(0,0,0,.65); font-weight: 500; }
.msg.agent { align-self: flex-start; background: var(--agent-bubble); color: var(--text); padding: 1rem 1.05rem 1.1rem; border-radius: 18px 18px 18px 4px; border: 1px solid rgba(var(--surface-border-rgb),0.35); backdrop-filter: blur(10px); }
.msg.info { align-self: center; font-size: .7rem; letter-spacing: .7px; padding: .35rem .55rem; border-radius: 999px; background: rgba(var(--surface-rgb),0.4); border: 1px solid rgba(var(--surface-border-rgb),0.35); color: var(--text-faint); }

/* Markdown content inside agent bubble */
.msg.agent pre, .tool-block pre { background: var(--code-bg); color: var(--code-text); padding: .85rem 1rem; border-radius: var(--radius-sm); font-family: var(--mono-stack); font-size: .75rem; margin: .85rem 0; box-shadow: inset 0 0 0 1px rgba(255,255,255,0.05); }
.msg.agent code, .tool-block code { font-family: var(--mono-stack); font-size: .75rem; background: rgba(var(--surface-rgb),0.16); padding: .2rem .45rem; border-radius: var(--radius-xs); }
.msg.agent h1, .msg.agent h2, .msg.agent h3 { margin: .85rem 0 .55rem; line-height: 1.15; }
.msg.agent p { margin: .55rem 0; }
.msg.agent ul, .msg.agent ol { margin: .6rem 0 .6rem 1.15rem; padding: 0; }

/* Tool column */
#toolsPane { flex: 1; overflow-y: auto; padding: .4rem .2rem .6rem .05rem; }
.tool-events { display: flex; flex-direction: column; gap: 1rem; }
.tool-block { background: var(--tool-bubble); padding: .9rem 1rem 1rem; border-radius: var(--radius); border: 1px solid rgba(var(--surface-border-rgb),0.35); position: relative; box-shadow: 0 4px 18px -6px rgba(0,0,0,.55), inset 0 0 0 1px rgba(255,255,255,0.05); }
.tool-block h3 { margin: 0 0 .55rem; font-size: .7rem; text-transform: uppercase; letter-spacing: 1px; color: #c4d0ff; font-weight: 600; display: flex; align-items: center; gap: .4rem; }
.tool-block pre { margin: 0; }

/* Metrics panel */
#metrics #tokenChart { width:100%; height:auto; image-rendering: pixelated; border:1px solid #1e3a43; background:#0a161b; box-shadow:0 0 0 1px #133038, 0 0 8px -2px rgba(0,255,149,.18); border-radius:8px; }
#metrics #tokenLegend { margin-top:.45rem; display:flex; flex-wrap:wrap; gap:.45rem .8rem; font-size:.62rem; letter-spacing:.5px; }
#metrics .legend-item { display:flex; align-items:center; gap:.35rem; background:#0d1b21; padding:.3rem .5rem .32rem; border:1px solid #143036; border-radius:6px; box-shadow:0 0 0 1px #11262b; }
#metrics .legend-item .swatch { width:10px; height:10px; border-radius:2px; background:var(--c); box-shadow:0 0 6px -1px var(--c); }
#metrics .metrics-footer { margin-top:.35rem; font-size:.55rem; text-transform:uppercase; letter-spacing:1px; color:var(--term-text-faint); }

/* Avatar panel */
#avatarPane { display: flex; justify-content: center; align-items: center; padding: 0.75rem; height: 100%; }
.agent-avatar { width: 100%; height: 100%; object-fit: contain; border-radius: var(--radius); border: 1px solid rgba(var(--surface-border-rgb),0.35); box-shadow: 0 4px 18px -6px rgba(0,0,0,.55); background: rgba(var(--surface-rgb),0.08); }

/* --- Layout stability & long content wrapping ---------------------------------
  Prevent any long, unbroken tool call output (JSON blobs, base64, etc.) from
  blowing out panel widths. We wrap aggressively and allow soft breaks
  everywhere while still preserving pre-style newlines. */
.tool-block, .msg.agent, .msg.user { word-break: break-word; overflow-wrap: anywhere; }
.tool-block pre, .msg.agent pre { white-space: pre-wrap; word-break: break-word; overflow-wrap: anywhere; max-width: 100%; overflow-x: hidden; }
.tool-block code, .msg.agent code { word-break: break-word; overflow-wrap: anywhere; }

/* Guard against flex children forcing overflow due to intrinsic min-width */
.panel, .messages, .tool-events, .tool-block, .msg { min-width: 0; }

.composer-wrapper { /* keep composer inside middle column and pinned to bottom */
  position: relative;
  margin-top: auto; /* push to bottom of middle column */
  width: 100%;
}
.composer-shell { width: 100%; box-sizing: border-box; }
.composer-shell { display: flex; align-items: flex-end; gap: .7rem; background: linear-gradient(140deg, rgba(var(--surface-rgb),0.65) 0%, rgba(var(--surface-rgb),0.32) 100%); border: 1px solid rgba(var(--surface-border-rgb),0.45); border-radius: var(--radius-lg); padding: .65rem .85rem .65rem 1rem; backdrop-filter: blur(var(--glass-blur)) saturate(var(--glass-sat)); box-shadow: 0 4px 22px -6px rgba(0,0,0,.55), inset 0 0 0 1px rgba(255,255,255,.08);
  transition: var(--transition); }
.composer-shell:focus-within { box-shadow: 0 0 0 2px rgba(var(--accent-rgb),.35), 0 6px 28px -10px rgba(var(--accent-rgb), .55); }
input#promptInput { flex: 1; background: transparent; border: none; outline: none; font-size: .92rem; font-family: var(--font-stack); color: var(--text); padding: .55rem .2rem; min-width: 0; }
input#promptInput::placeholder { color: var(--text-faint); letter-spacing: .3px; }
button#submitBtn { background: var(--gradient-accent); color: #fff; font-weight: 600; border: none; cursor: pointer; border-radius: var(--radius-sm); padding: .75rem 1rem .8rem; font-size: .75rem; letter-spacing: .8px; text-transform: uppercase; display: inline-flex; align-items: center; gap: .45rem; box-shadow: 0 4px 14px -4px rgba(var(--accent-rgb),.65), 0 2px 4px -2px rgba(var(--accent-rgb),.55); transition: var(--transition); }
button#submitBtn:hover { filter: brightness(1.1); transform: translateY(-1px); }
button#submitBtn:active { transform: translateY(0); }
/* Microphone button (default glass theme) */
button#micBtn { background: rgba(var(--surface-rgb),0.18); border: 1px solid rgba(var(--surface-border-rgb),0.45); color: var(--text-soft); font-size: .95rem; line-height: 1; padding: .7rem .8rem .75rem; border-radius: var(--radius-sm); cursor: pointer; display: inline-flex; align-items: center; justify-content: center; box-shadow: 0 2px 8px -3px rgba(0,0,0,.45), inset 0 0 0 1px rgba(255,255,255,.06); transition: var(--transition); position: relative; }
button#micBtn:hover { color: var(--text); box-shadow: 0 0 0 1px rgba(var(--accent-rgb),.35), 0 4px 14px -4px rgba(var(--accent-rgb),.4); }
button#micBtn.recording { background: linear-gradient(135deg,#d32f2f,#ff5252); color:#fff; border-color:#ff6d6d; box-shadow: 0 0 0 1px rgba(255,90,90,.6),0 0 16px -2px rgba(255,70,70,.55),0 0 4px 1px rgba(255,140,140,.35); animation: pulseRec 1.1s ease-in-out infinite; }
button#micBtn.recording::after { content:"REC"; position:absolute; top:4px; right:6px; font-size:9px; letter-spacing:1px; font-weight:600; opacity:.85; }
@keyframes pulseRec { 0%,100% { transform: translateY(0) scale(1); filter:brightness(1); } 50% { transform: translateY(-1px) scale(1.04); filter:brightness(1.15); } }

/* Utility */
.fade-dim { opacity: .7; }
.hidden { display: none !important; }

@keyframes fadeIn { from { opacity: 0; transform: translateY(4px); } to { opacity: 1; transform: translateY(0); } }

/* Responsive adjustments */
@media (max-width: 1400px) { .col-left { display:none; } .col-middle { flex: 2.2; } .col-right { flex: 1.5; } }
@media (max-width: 1100px) { main.layout { flex-direction: column; } .col-left { display:none; } .col-right { order: 3; } .col-middle { order: 2; } }
@media (max-width: 680px) { .tool-block h3 { font-size: .62rem; } button#submitBtn { padding: .65rem .85rem .7rem; } }

/* =====================================================================
   Terminal / Hacker Tool Theme Overrides
   (Layout metrics unchanged. Only colors, typography, visual styling.)
   To revert, remove this override section. Placed at end for precedence.
   ===================================================================== */

/* Core palette */
:root {
  --term-bg: #05080c;
  --term-bg-alt: #0b1116;
  --term-surface: #0f161d;
  --term-surface-alt: #121d26;
  --term-border: #1e2f38;
  --term-border-strong: #2f4a55;
  --term-accent: #00c853; /* primary neon green */
  --term-accent-soft: #0d3d26;
  --term-accent-alt: #35e380;
  --term-warn: #f0c674;
  --term-danger: #ff5555;
  --term-text: #d2f6e5;
  --term-text-soft: #8bb6a5;
  --term-text-faint: #4d6a60;
  --term-code-bg: #01090d;
  --term-code-accent: #00ff95;
  --term-scroll-track: #0b151b;
  --term-scroll-thumb: #113a26;
  --term-glow: 0 0 0 1px rgba(0,200,83,.25), 0 0 12px -2px rgba(0,255,149,.35);
  --term-font-ui: 'JetBrains Mono', 'Fira Code', 'SFMono-Regular', Menlo, Monaco, Consolas, 'Liberation Mono', monospace;
}

/* Replace global font + background */
body {
  font-family: var(--term-font-ui);
  background: radial-gradient(circle at 20% 18%, #0d28181a, transparent 60%),
              radial-gradient(circle at 80% 70%, #0d28180d, transparent 70%),
              var(--term-bg);
  color: var(--term-text);
}

body::before { /* subtle grid + scanline */
  background: repeating-linear-gradient(90deg, rgba(0,255,149,0.04) 0 1px, transparent 1px 120px),
              repeating-linear-gradient(0deg, rgba(0,255,149,0.025) 0 1px, transparent 1px 120px),
              repeating-linear-gradient(0deg, rgba(255,255,255,0.01) 0 2px, transparent 2px 4px);
  mask: linear-gradient(to bottom, black, black 70%, transparent 100%);
  opacity: .35;
}

header.site-header {
  background: linear-gradient(90deg, #071218, #0f1c24);
  border-bottom: 1px solid var(--term-border);
  backdrop-filter: none; -webkit-backdrop-filter: none;
  box-shadow: inset 0 0 0 1px #122833, 0 2px 10px -4px #000;
  justify-content: center;
}
.logo {
  color: var(--term-accent-alt);
  background: none; filter: none; text-shadow: none;
  letter-spacing: 1px;
}


/* Panels */
.panel::before { display: none; }
.panel-header { color: var(--term-text-faint); }

/* Chat bubbles */
.msg {
  display: flex;
  flex-direction: column;
  margin-bottom: 1rem;
  padding: 1rem;
  border-radius: var(--radius);
  position: relative;
}
.msg.user {
  background: linear-gradient(160deg,#063a21,#0b5d32 60%,#0f7a44);
  box-shadow: 0 0 0 1px #15613a, 0 0 14px -2px rgba(0,255,149,.35);
  color: #d6ffe9;
  font-weight: 500;
  align-self: flex-end;
  max-width: 80%;
}
.msg.agent {
  background: #101c22;
  border: 1px solid #1d3a44;
  box-shadow: 0 0 0 1px #132c33, 0 0 10px -3px rgba(0,255,149,.25);
  color: var(--term-text);
  align-self: flex-start;
  max-width: 80%;
}
.msg.info {
  background: #0f1f25;
  border: 1px solid #1c363f;
  color: var(--term-text-faint);
  align-self: center;
  max-width: 60%;
}

.msg .timestamp {
  font-size: 0.75rem;
  opacity: 0.7;
  margin-top: 0.5rem;
  align-self: flex-end;
}

/* Tool blocks */
.tool-block {
  background: #0d1a1f;
  border: 1px solid #1e3a43;
  box-shadow: 0 0 0 1px #163036, 0 0 8px -2px rgba(0,255,149,.25);
}
.tool-block h3 { color: var(--term-accent-alt); }

/* Composer */
.composer-shell {
  background: #0d1b21;
  border: 1px solid #1e3942;
  backdrop-filter: none; -webkit-backdrop-filter: none;
  box-shadow: 0 0 0 1px #153036, 0 0 12px -4px rgba(0,255,149,.25);
}
.composer-shell:focus-within { box-shadow: 0 0 0 1px var(--term-accent), 0 0 14px 0 rgba(0,255,149,.45); }
input#promptInput { color: var(--term-text); }
input#promptInput::placeholder { color: var(--term-text-faint); }
button#submitBtn {
  background: linear-gradient(90deg,var(--term-accent) 0%, var(--term-accent-alt) 100%);
  box-shadow: 0 0 0 1px #0c3a24, 0 0 14px -2px rgba(0,255,149,.45);
  letter-spacing: 1px;
}
button#submitBtn:hover { filter: brightness(1.12); }
/* Mic button (terminal theme override) */
button#micBtn { background:#0c181d; border:1px solid #1a3a44; color: var(--term-text-faint); box-shadow:0 0 0 1px #102b30, 0 0 10px -3px rgba(0,255,149,.25), inset 0 0 0 1px rgba(255,255,255,0.04); font-weight:500; font-family: var(--term-font-ui); }
button#micBtn:hover { color: var(--term-accent-alt); border-color:#21514f; box-shadow:0 0 0 1px #1c544b, 0 0 14px -4px rgba(0,255,149,.38); }
button#micBtn.recording { background: linear-gradient(135deg,#611010,#b71c1c); border-color:#ff5252; color:#ffecec; box-shadow:0 0 0 1px #651c1c,0 0 18px -2px rgba(255,80,80,.55),0 0 6px 0 rgba(255,60,60,.4); }
button#micBtn.recording::after { color:#ffd4d4; text-shadow:0 0 6px rgba(255,120,120,.8); }

/* Code blocks */
.msg.agent pre, .tool-block pre {
  background: var(--term-code-bg);
  color: var(--term-code-accent);
  box-shadow: inset 0 0 0 1px #0d3a2a;
}
.msg.agent code, .tool-block code {
  background: #0d2a19;
  color: var(--term-accent-alt);
}

/* Scrollbars */
#chatPane::-webkit-scrollbar-thumb, #toolsPane::-webkit-scrollbar-thumb {
  background: linear-gradient(var(--term-accent), var(--term-accent-alt));
}
#chatPane::-webkit-scrollbar-track, #toolsPane::-webkit-scrollbar-track { background: var(--term-scroll-track); }

/* Links (if any rendered in markdown) */
.msg.agent a { color: var(--term-accent-alt); text-decoration: none; border-bottom: 1px dashed #1d5a3b; }
.msg.agent a:hover { color: var(--term-accent); border-bottom-color: var(--term-accent); }

/* Selection */
::selection { background: #0c3f28; color: #d2ffe9; }

/* Copy button (bottom-left) + timestamp alignment for agent messages */
.msg.agent { position: relative; padding-bottom: 38px; }
.copy-btn {
  --btn-bg: rgba(0,255,149,0.06);
  --btn-border: #124b32;
  position: absolute;
  bottom: 8px;
  left: 10px;
  background: var(--btn-bg);
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
  border: 1px solid var(--btn-border);
  color: var(--term-accent-alt);
  cursor: pointer;
  font-size: 11px;
  line-height: 1;
  padding: 4px 10px 5px;
  border-radius: 4px;
  display: flex;
  align-items: center;
  gap: 4px;
  font-family: var(--term-font-ui);
  letter-spacing: .8px;
  text-transform: uppercase;
  opacity: .82;
  box-shadow: 0 0 0 1px #0b2d1e, 0 0 0 2px rgba(0,200,83,0.08), 0 0 10px -4px rgba(0,255,149,.35);
  transition: background .18s ease, color .18s ease, border-color .18s ease, opacity .18s, box-shadow .25s ease;
}
.msg.agent:hover > .copy-btn { opacity: 1; }
.copy-btn:hover {
  background: rgba(0,255,149,0.12);
  color: var(--term-accent);
  border-color: #1e6f4b;
  box-shadow: 0 0 0 1px #145236, 0 0 0 2px rgba(0,200,83,0.25), 0 0 14px -2px rgba(0,255,149,.55);
}
.copy-btn.copied {
  background: linear-gradient(135deg, rgba(0,255,149,0.16), rgba(0,180,110,0.22));
  color: var(--term-accent);
  border-color: #25a068;
  box-shadow: 0 0 0 1px #166844, 0 0 0 2px rgba(0,255,149,0.32), 0 0 18px -2px rgba(0,255,149,.65);
}
.msg .timestamp { font-size: 0.7rem; }
.msg.agent .timestamp { position: absolute; bottom: 10px; right: 14px; margin-top:0; opacity:.55; }

/* Code block copy buttons */
/* Code block copy buttons reuse identical .copy-btn styling; only override positioning */
.code-copy-btn { position: absolute; right: 8px; top: 8px; left: auto; bottom: auto; width: auto; height: auto; }
.msg.agent pre, .tool-block pre { position: relative; }
.floating-code-copy {
  position: fixed !important;
  top: 8px; /* will be overridden dynamically */
  right: 16px; /* fallback */
  z-index: 500;
  opacity: .9;
  background: #0a281c !important;
  border: 1px solid #155a3b !important;
  box-shadow: 0 0 0 1px #0d3a26, 0 0 12px -4px rgba(0,255,149,.45);
  display: flex;
}

/* Remove original glassmorphism blur where lingering */
header.site-header, .panel, .composer-shell, .theme-toggle { -webkit-backdrop-filter: none !important; backdrop-filter: none !important; }
